<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Location Based - AR.js Documentation</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/docco.min.css">

        <script src="../js/jquery-1.10.2.min.js" defer></script>
        <script src="../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">AR.js Documentation</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href=".." class="nav-link">Home</a>
                            </li>
                            <li class="navitem">
                                <a href="../image-tracking/" class="nav-link">Image Tracking</a>
                            </li>
                            <li class="navitem active">
                                <a href="./" class="nav-link">Location Based</a>
                            </li>
                            <li class="navitem">
                                <a href="../marker-based/" class="nav-link">Marker Based</a>
                            </li>
                            <li class="navitem">
                                <a href="../ui-events/" class="nav-link">UI and Events</a>
                            </li>
                            <li class="navitem">
                                <a href="../about/" class="nav-link">About</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../image-tracking/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../marker-based/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#location-based" class="nav-link">Location Based</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#projected-camera-version" class="nav-link">Projected Camera Version</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="location-based">Location Based</h1>
<p>Location Based has been implemented only for A-Frame framework.</p>
<p><a href="https://medium.com/chialab-open-source/build-your-location-based-augmented-reality-web-app-c2442e716564">This article </a> gives you a first glance to Location Based on AR.js.
It can be used for indoor (but with low precision) and outdoor geopositioning of AR content.</p>
<p>You can load places statically, from HTML or from Javascript, or you can load your data from local/remote json, or even through API calls. Choice is yours. On the article above there are all the options explained, as tutorials.</p>
<p>Following there's the API Reference.</p>
<h3 id="gps-camera"><code>gps-camera</code></h3>
<p><strong>Required</strong>: yes</p>
<p><strong>Max allowed per scene</strong>: 1</p>
<p>This component enables the Location AR. It has to be added to the <code>camera</code> entity.
It makes possible to handle both position and rotation of the camera and it's used to determine where the user is pointing their device.</p>
<p>For example:</p>
<pre><code class="HTML">&lt;a-camera gps-camera rotation-reader&gt;&lt;/a-camera&gt;
</code></pre>

<p>In addition to that, as you can see on the example above, we also have to add <code>rotation-reader</code> to handle rotation events. See <a href="https://aframe.io/docs/0.9.0/components/camera.html#reading-position-or-rotation-of-the-camera">here</a> for more details.</p>
<h3 id="properties">Properties</h3>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
<th>Default Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>alert</td>
<td>Whether to show a message when GPS signal is under the <code>positionMinAccuracy</code></td>
<td>false</td>
</tr>
<tr>
<td>positionMinAccuracy</td>
<td>Minimum accuracy allowed for position signal</td>
<td>100</td>
</tr>
<tr>
<td>minDistance</td>
<td>If set, places with a distance from the user lower than this value, are not showed. Only a positive value is allowed. Value is in meters.</td>
<td>0 (disabled)</td>
</tr>
<tr>
<td>maxDistance</td>
<td>If set, places with a distance from the user higher than this value, are not showed. Only a positive value is allowed. Value is in meters.</td>
<td>0 (disabled)</td>
</tr>
<tr>
<td>simulateLatitude</td>
<td>Setting this allows you to simulate the latitude of the camera, to aid in testing.</td>
<td>0 (disabled)</td>
</tr>
<tr>
<td>simulateLongitude</td>
<td>Setting this allows you to simulate the longitude of the camera, to aid in testing.</td>
<td>0 (disabled)</td>
</tr>
<tr>
<td>simulateAltitude</td>
<td>Setting this allows you to simulate the altitude of the camera in meters above sea level, to aid in testing.</td>
<td>0 (disabled)</td>
</tr>
</tbody>
</table>
<h3 id="gps-entity-place"><code>gps-entity-place</code></h3>
<p><strong>Required</strong>: yes</p>
<p><strong>Max allowed per scene</strong>: no limit</p>
<p>This component makes each entity GPS-trackable. This assigns a specific world position to an entity, so that the user can see it when their device is pointing to its position in the real world. If the user is far from the entity, it will seem smaller. If it's too far away, it won't be seen at all.</p>
<p>It requires latitude and longitude as a single string parameter (example with <code>a-box</code> aframe primitive):</p>
<pre><code class="HTML">&lt;a-box material=&quot;color: yellow&quot; gps-entity-place=&quot;latitude: &lt;your-latitude&gt;; longitude: &lt;your-longitude&gt;&quot;/&gt;
</code></pre>

<p>⚡️ In addition, you can use the a-frame "position" parameter to assign a y-value to change the height of the content.
This value should be entered as meters above or below (if negative) the current camera height. For example, this would assign a height of 30 meters, and will be displayed relative to the gps-camera's current height:</p>
<pre><code class="HTML">&lt;a-box material=&quot;color: yellow&quot; gps-entity-place=&quot;latitude: &lt;your-latitude&gt;; longitude: &lt;your-longitude&gt;&quot; position=&quot;0 30 0&quot;/&gt;
</code></pre>

<h3 id="properties_1">Properties</h3>
<p>No real property apart from the string that defined latitude and longitude together, as shown above.</p>
<h3 id="custom-attributes">Custom Attributes</h3>
<p>The following are Custom Attributes that can be retrieved from <code>gps-entity-place</code> entities, for example:</p>
<pre><code class="js">const distanceMsg = document.querySelector('[gps-entity-place]').getAttribute('distanceMsg');
console.log(distanceMsg);   // &quot;890 meters&quot;
</code></pre>

<table>
<thead>
<tr>
<th>Custom Attribute</th>
<th>Description</th>
<th>Default Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>distance</td>
<td>Distance from user, updated at every user position update. Value in meters.</td>
<td>0</td>
</tr>
<tr>
<td>distanceMsg</td>
<td>Distance from user as string, with unit, updated at every user position update. Value as <code>&lt;distance&gt; meters/kilometers</code>.</td>
<td>''</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="events">Events</h3>
<p>Take a look at the <a href="../ui-events/">UI and Events</a> page for Location Based Custom Events.</p>
<hr />
<p>⚡️ Usually, in Location Based, it's nice to have the augmented content that will always face the user, so when you rotate the camera, 3D models or most of all, text, are well visible.</p>
<p>Look at <a href="https://github.com/AR-js-org/AR.js/tree/master/aframe/examples/location-based/always-face-user">this example</a> in order to create <code>gps-entity-place</code> entities that will always face the user (camera).</p>
<h2 id="projected-camera-version">Projected Camera Version</h2>
<p>The experimental 'projected camera' version of the location-based components for AR.js uses <a href="https://www.maptiler.com/google-maps-coordinates-tile-bounds-projection">Spherical Mercator</a> (aka EPSG:3857) to store both the camera position and the position of added points of interest and other geographical data.</p>
<p>The rationale for this version is to allow easy addition of more complex geographic data such as roads and paths. Such data can be projected and added to an AR.js scene, and then, because Spherical Mercator units approximate to metres (away from the poles), the coordinates can be used directly as WebGL/A-Frame world coordinates.</p>
<p>The two components for the projected camera version are <code>gps-projected-camera</code> and <code>gps-projected-entity-place</code>. Their interface is almost identical to <code>gps-camera</code> and <code>gps-entity-place</code> but they work differently internally.</p>
<p>For example:</p>
<pre><code class="HTML">&lt;a-camera gps-projected-camera rotation-reader&gt;&lt;/a-camera&gt;
</code></pre>

<p>and:</p>
<pre><code class="HTML">&lt;a-box color=&quot;yellow&quot; gps-projected-entity-place=&quot;latitude: &lt;your-latitude&gt;; longitude: &lt;your-longitude&gt;&quot;/&gt;
</code></pre>

<p>Note that internally, the latitude and longitude are converted to Spherical Mercator coordinates.</p>
<p>As for <code>gps-entity-place</code>, you can specify an altitude using the <em>y</em> component of the <code>position</code> attribute:</p>
<pre><code class="HTML">&lt;a-box color=&quot;yellow&quot; gps-projected-entity-place=&quot;latitude: &lt;your-latitude&gt;; longitude: &lt;your-longitude&gt;&quot; position=&quot;0 30 0&quot;/&gt;
</code></pre>

<h3 id="calculating-world-coordinates-of-arbitrary-augmented-content">Calculating world coordinates of arbitrary augmented content</h3>
<p><code>gps-projected-camera</code> has some useful properties and methods which can be used to easily work with arbitrary augmented content (for example, polylines or polygons sourced from geodata APIs such as <a href="https://openstreetmap.org">OpenStreetMap</a>). Before introducing these, it needs to be made clear that, in <code>gps-projected-camera</code>, the <strong>original GPS position</strong> is set as the world origin. So, if arbitrary content is to be added to the scene, and the source coordinates for this content is in unprojected (WGS84) latitude and longitude, it needs to be:</p>
<ul>
<li>projected to Spherical Mercator;</li>
<li>and then converted to world coordinates relative to the original GPS position.</li>
</ul>
<p>On the other hand, only the second step is needed if the source coordinates are already projected. We'll look at each scenario now.</p>
<h4 id="source-data-in-wgs84-latitudelongitude">Source data in WGS84 latitude/longitude</h4>
<p>The <code>latLonToWorld(lat, lon)</code> method of the <code>gps-projected-camera</code> component converts latitude and longitude directly to world coordinates, performing the projection as the first step and then calculating the world coordinates from the projected coordinates. It will return a 2-member array containing the <em>x</em> and <em>z</em> world coordinates, allowing the developer to calculate or specify the <em>y</em> coordinate (altitude) independently.</p>
<h4 id="source-data-in-spherical-mercator">Source data in Spherical Mercator</h4>
<p>An alternative scenario is when the augmented content has already been projected into Spherical Mercator and therefore does not need the initial projection step when added to an AR.js scene. This may occur when an API serves data in Spherical Mercator, for instance. In this case, we still need to convert the Spherical Mercator coordinates to world coordinates relative to the original GPS position. <code>gps-projected-camera</code> has an <code>originCoordsProjected</code> property, which represents the original GPS position in Spherical Mercator coordinates. This is a two-member array, containing the Spherical Mercator easting and northing, respectively, of the origin point. From this, we can therefore work out the world coordinates from Spherical Mercator coordinates:</p>
<ul>
<li><code>xWorld = featureEasting - originCoordsProjected[0]</code></li>
</ul>
<p>and</p>
<ul>
<li><code>zWorld = -(featureNorthing - originCoordsProjected[1])</code></li>
</ul>
<p>where <code>xWorld</code> and <code>zWorld</code> are the world <em>x</em> and <em>z</em> coordinates of the augmented content, and <code>featureEasting</code> and <code>featureNorthing</code> are the content's Spherical Mercator coordinates. Note how we have to reverse the sign of <em>z</em> as increasing Spherical Mercator easting corresponds to increasing <em>x</em> in OpenGL coordinates, and increasing altitude corresponds to increasing <em>y</em>, but increasing Spherical Mercator northing corresponds to <strong>decreasing</strong> <em>z</em>.</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js" defer></script>
        <script src="../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
