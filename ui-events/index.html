<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>UI and Events - AR.js Documentation</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/docco.min.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">AR.js Documentation</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href=".." class="nav-link">Home</a>
                            </li>
                            <li class="navitem">
                                <a href="../image-tracking/" class="nav-link">Image Tracking</a>
                            </li>
                            <li class="navitem">
                                <a href="../location-based/" class="nav-link">Location Based</a>
                            </li>
                            <li class="navitem">
                                <a href="../marker-based/" class="nav-link">Marker Based</a>
                            </li>
                            <li class="navitem active">
                                <a href="./" class="nav-link">UI and Events</a>
                            </li>
                            <li class="navitem">
                                <a href="../about/" class="nav-link">About</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../marker-based/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../about/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#ui-and-custom-events" class="nav-link">UI and Custom Events</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#handle-clicks-on-ar-content" class="nav-link">Handle clicks on AR content</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#interaction-with-overlayed-dom-content" class="nav-link">Interaction with Overlayed DOM content</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#custom-events" class="nav-link">Custom Events</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#trigger-actions-when-image-has-been-found" class="nav-link">Trigger actions when image has been found</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#trigger-action-when-marker-has-been-found" class="nav-link">Trigger action when marker has been found</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#get-distance-from-marker" class="nav-link">Get distance from marker</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="ui-and-custom-events">UI and Custom Events</h1>
<p>To make AR.js based Web App look better and add UI capabilities, it's possible to treat is as common website.
Here you will learn how to use Raycaster, Custom Events and Interaction with overlayed DOM elements.</p>
<h2 id="handle-clicks-on-ar-content">Handle clicks on AR content</h2>
<p><img src='https://miro.medium.com/max/1200/1*7aR8--E_lqt91Ziw1VCCTw.gif' /></p>
<p>It's now possible to use AR.js (marker based or image tracking) with a-frame latest versions (1.0.0 and above) in order
to have touch gestures to zoom and rotate your content! Disclaimer: this will work for your entire <code>a-scene</code>, so it's not a real
option if you have to handle different interactions for multiple markers. It will work like charm if you have one marker/image for scene.</p>
<p>Check Fabio Cortès <a href="https://medium.com/@fabiojcortes/manipulate-your-3d-content-with-gestures-in-ar-js-78da4c076607">great walkthrough</a> in order to add this feature on your AR.js web app.</p>
<p>You can use this exact approach for Image Tracking <code>a-nft</code> and Marker Based <code>a-entity</code> elements.
The <code>clickhandler</code> name can be customized, you can choose the one you like most, it's just a reference.</p>
<p>Keep in mind that this click/touch interaction is not handled by AR.js at all, it is all A-Frame based.
Always look on the A-Frame documentation for more details.</p>
<p><a href="https://medium.com/@fabiojcortes/manipulate-your-3d-content-with-gestures-in-ar-js-78da4c076607">Check out the tutorial</a></p>
<h2 id="interaction-with-overlayed-dom-content">Interaction with Overlayed DOM content</h2>
<p>You can add interations by adding DOM HTML elements on the <code>body</code>.
For example, starting from this example:</p>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;script src=&quot;https://aframe.io/releases/1.0.4/aframe.min.js&quot;&gt;&lt;/script&gt;
  &lt;!-- we import arjs version without NFT but with marker + location based support --&gt;
  &lt;script src=&quot;https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js&quot;&gt;&lt;/script&gt;
  &lt;body style=&quot;margin : 0px; overflow: hidden;&quot;&gt;
    &lt;a-scene embedded arjs&gt;
      &lt;a-marker preset=&quot;hiro&quot;&gt;
        &lt;!-- we use cors proxy to avoid cross-origin problems --&gt;

        &lt;!--
          ⚠️⚠️⚠️
          https://arjs-cors-proxy.herokuapp.com/ is now offline, Heroku has dismissed all his free plans from November 2022.
          You need to host your own proxy and use it instead. The proxy is based on CORS Anywhere (see https://github.com/Rob--W/cors-anywhere).
          ⚠️⚠️⚠️
        --&gt;
        &lt;a-entity
          position=&quot;0 0 0&quot;
          scale=&quot;0.05 0.05 0.05&quot;
          gltf-model=&quot;https://arjs-cors-proxy.herokuapp.com/https://raw.githack.com/AR-js-org/AR.js/master/aframe/examples/image-tracking/nft/trex/scene.gltf&quot;
        &gt;&lt;/a-entity&gt;
      &lt;/a-marker&gt;
      &lt;a-entity camera&gt;&lt;/a-entity&gt;
    &lt;/a-scene&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>We can add on the body, outside the <code>a-scene</code>:</p>
<pre><code class="language-html">&lt;div class=&quot;buttons&quot;&gt;
  &lt;button class=&quot;say-hi-button&quot;&gt;&lt;/button&gt;
&lt;/div&gt;
</code></pre>
<p>Then, we need to add some CSS to absolute positioning the DIV and BUTTON, and also some scripting to listen to click events.</p>
<p>You can customize your <code>a-scene</code> or content, like 3D models, play video, and so on. See on A-Frame Docs on how to change entity properties and work with events: https://aframe.io/docs/1.0.0/introduction/javascript-events-dom-apis.html.</p>
<p>We will end up with the following code:</p>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;script src=&quot;https://aframe.io/releases/1.0.4/aframe.min.js&quot;&gt;&lt;/script&gt;
  &lt;!-- we import arjs version without NFT but with marker + location based support --&gt;
  &lt;script src=&quot;https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js&quot;&gt;&lt;/script&gt;
  &lt;script&gt;
    window.onload = function () {
      document
        .querySelector(&quot;.say-hi-button&quot;)
        .addEventListener(&quot;click&quot;, function () {
          // here you can change also a-scene or a-entity properties, like
          // changing your 3D model source, size, position and so on
          // or you can just open links, trigger actions...
          alert(&quot;Hi there!&quot;);
        });
    };
  &lt;/script&gt;
  &lt;style&gt;
    .buttons {
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 5em;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 10;
    }

    .say-hi-button {
      padding: 0.25em;
      border-radius: 4px;
      border: none;
      background: white;
      color: black;
      width: 4em;
      height: 2em;
    }
  &lt;/style&gt;
  &lt;body style=&quot;margin : 0px; overflow: hidden;&quot;&gt;
    &lt;div class=&quot;buttons&quot;&gt;
      &lt;button class=&quot;say-hi-button&quot;&gt;SAY HI!&lt;/button&gt;
    &lt;/div&gt;
    &lt;a-scene embedded arjs&gt;
      &lt;a-marker preset=&quot;hiro&quot;&gt;
        &lt;a-entity
          position=&quot;0 0 0&quot;
          scale=&quot;0.05 0.05 0.05&quot;
          gltf-model=&quot;https://arjs-cors-proxy.herokuapp.com/https://raw.githack.com/AR-js-org/AR.js/master/aframe/examples/image-tracking/nft/trex/scene.gltf&quot;
        &gt;&lt;/a-entity&gt;
      &lt;/a-marker&gt;
      &lt;a-entity camera&gt;&lt;/a-entity&gt;
    &lt;/a-scene&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre>
<h2 id="custom-events">Custom Events</h2>
<p>AR.js dispatches several Custom Events.</p>
<p>Some of them are general, others are specific for AR Feature. Here's the full list.</p>
<table>
<thead>
<tr>
<th>Custom Event name</th>
<th>Description</th>
<th>Payload</th>
<th>Source File</th>
<th>Feature</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>arjs-video-loaded</code></td>
<td>Fired when camera video stream has been appended to the DOM</td>
<td><code>{ detail: { component: &lt;HTMLElement&gt; }}</code></td>
<td>threex-artoolkitsource.js</td>
<td>all</td>
</tr>
<tr>
<td><code>camera-error</code></td>
<td>Fired when camera video stream could not be retrieved</td>
<td><code>{ error: &lt;Error&gt; }</code></td>
<td>threex-artoolkitsource.js</td>
<td>all</td>
</tr>
<tr>
<td><code>camera-init</code></td>
<td>Fired when camera video stream has been retrieved correctly</td>
<td><code>{ stream: &lt;MediaStream&gt; }</code></td>
<td>threex-artoolkitsource.js</td>
<td>all</td>
</tr>
<tr>
<td><code>markerFound</code></td>
<td>Fired when a marker in Marker Based, or a picture in Image Tracking, has been found</td>
<td>-</td>
<td>component-anchor.js</td>
<td>only Image Tracking and Marker Based</td>
</tr>
<tr>
<td><code>markerLost</code></td>
<td>Fired when a marker in Marker Based, or a picture in Image Tracking, has been lost</td>
<td>-</td>
<td>component-anchor.js</td>
<td>only Image Tracking and Marker Based</td>
</tr>
<tr>
<td><code>arjs-nft-loaded</code></td>
<td>Fired when a nft marker is full loaded</td>
<td></td>
<td>threex-armarkercontrols-nft-start.js</td>
<td>only Image Tracking</td>
</tr>
<tr>
<td><code>gps-camera-update-positon</code></td>
<td>Fired when <code>gps-camera</code> has updated its position</td>
<td><code>{ detail:</code> <code>{ position: &lt;GeolocationCoordinates&gt;,</code> <code>origin: &lt;GeolocationCoordinates&gt; }}</code></td>
<td>gps-camera.js</td>
<td>only Location Based</td>
</tr>
<tr>
<td><code>gps-entity-place-update-positon</code></td>
<td>Fired when <code>gps-entity-place</code> has updated its position</td>
<td><code>{ detail: { distance: &lt;Number&gt; }}</code></td>
<td>gps-entity-place.js</td>
<td>only classic and projected Location Based</td>
</tr>
<tr>
<td><code>gps-entity-place-added</code></td>
<td>Fired when the <code>gps-entity-place</code> has been added</td>
<td><code>{ detail: { component: &lt;HTMLElement&gt; }}</code></td>
<td>gps-entity-place.js</td>
<td>only classic and projected Location Based</td>
</tr>
<tr>
<td><code>gps-camera-origin-coord-set</code></td>
<td>Fired when the origin coordinates are set</td>
<td>-</td>
<td>gps-camera.js</td>
<td>only classic and projected Location Based</td>
</tr>
<tr>
<td><code>gps-entity-place-loaded</code></td>
<td>Fired when the <code>gps-entity-place</code> has been - see 'loaded' event of A-Frame entities</td>
<td><code>{ detail: { component: &lt;HTMLElement&gt; }}</code></td>
<td>gps-entity-place.js</td>
<td>only classic and projected Location Based</td>
</tr>
</tbody>
</table>
<h3 id="internal-loading-events">Internal Loading Events</h3>
<p>⚡️ Both Image Tracking and Location Based automatically handle an internal event when</p>
<ul>
<li>origin location has been set</li>
<li>Image Tracking (Image Descriptors) are fully loaded</li>
</ul>
<p>And automatically remove from the DOM elements that match the <code>.arjs-loader</code> selector.</p>
<p>You can add any custom loader that will be remove in the above situations, just use the <code>.arjs-loader</code> class on it.</p>
<h2 id="trigger-actions-when-image-has-been-found">Trigger actions when image has been found</h2>
<p>You can trigger any action you want when marker/image has been found. You can avoid linking a content to a marker/image and
only trigger an action (like a redirect to an external website) when the anchor has been found by the camera.</p>
<pre><code class="language-html">&lt;script src=&quot;https://cdn.jsdelivr.net/gh/aframevr/aframe@1c2407b26c61958baa93967b5412487cd94b290b/dist/aframe-master.min.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js&quot;&gt;&lt;/script&gt;

&lt;style&gt;
  .arjs-loader {
    height: 100%;
    width: 100%;
    position: absolute;
    top: 0;
    left: 0;
    background-color: rgba(0, 0, 0, 0.8);
    z-index: 9999;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .arjs-loader div {
    text-align: center;
    font-size: 1.25em;
    color: white;
  }
&lt;/style&gt;
&lt;script&gt;
  AFRAME.registerComponent('markerhandler', {
    init: function () {
      this.el.sceneEl.addEventListener('markerFound', () =&gt; {
        // redirect to custom URL
        window.location = 'https://github.com/AR-js-org/AR.js';
      });
  });
  },
&lt;/script&gt;

&lt;body style=&quot;margin : 0px; overflow: hidden;&quot;&gt;
  &lt;!-- minimal loader shown until image descriptors are loaded --&gt;
  &lt;div class=&quot;arjs-loader&quot;&gt;
    &lt;div&gt;Loading, please wait...&lt;/div&gt;
  &lt;/div&gt;
  &lt;a-scene
    vr-mode-ui=&quot;enabled: false;&quot;
    renderer=&quot;logarithmicDepthBuffer: true;&quot;
    embedded
    arjs=&quot;trackingMethod: best; sourceType: webcam;debugUIEnabled: false;&quot;
  &gt;
    &lt;!-- we use cors proxy to avoid cross-origin problems --&gt;
    &lt;!-- we use the trex image shown on the homepage of the docs --&gt;
    &lt;a-nft
      markerhandler
      type=&quot;nft&quot;
      url=&quot;https://arjs-cors-proxy.herokuapp.com/https://raw.githack.com/AR-js-org/AR.js/master/aframe/examples/image-tracking/nft/trex/trex-image/trex&quot;
    &gt;
    &lt;/a-nft&gt;
    &lt;a-entity camera&gt;&lt;/a-entity&gt;
  &lt;/a-scene&gt;
&lt;/body&gt;
</code></pre>
<h2 id="trigger-action-when-marker-has-been-found">Trigger action when marker has been found</h2>
<pre><code class="language-html">&lt;script src=&quot;https://cdn.jsdelivr.net/gh/aframevr/aframe@1c2407b26c61958baa93967b5412487cd94b290b/dist/aframe-master.min.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js&quot;&gt;&lt;/script&gt;

&lt;script&gt;
  AFRAME.registerComponent('markerhandler', {
    init: function () {
      this.el.sceneEl.addEventListener('markerFound', () =&gt; {
        // redirect to custom URL e.g. google.com
        window.location = 'https://www.google.com/';
      })
    }
  });
&lt;/script&gt;

&lt;body style=&quot;margin : 0px; overflow: hidden;&quot;&gt;
  &lt;a-scene
    vr-mode-ui=&quot;enabled: false;&quot;
    renderer=&quot;logarithmicDepthBuffer: true;&quot;
    embedded
    arjs=&quot;trackingMethod: best; sourceType: webcam; debugUIEnabled: false; detectionMode: mono_and_matrix; matrixCodeType: 3x3;&quot;&gt;

    &lt;a-marker markerhandler type='barcode' value='7'&gt;
        &lt;a-box position='0 0.5 0' color=&quot;yellow&quot;&gt;&lt;/a-box&gt;
    &lt;/a-marker&gt;

    &lt;a-entity camera&gt;&lt;/a-entity&gt;
  &lt;/a-scene&gt;
&lt;/body&gt;
</code></pre>
<h2 id="get-distance-from-marker">Get distance from marker</h2>
<pre><code>// import this on your HTML
window.addEventListener('load', () =&gt; {
    const camera = document.querySelector('[camera]');
    const marker = document.querySelector('a-marker');
    let check;

    marker.addEventListener('markerFound', () =&gt; {
        let cameraPosition = camera.object3D.position;
        let markerPosition = marker.object3D.position;
        let distance = cameraPosition.distanceTo(markerPosition)

        check = setInterval(() =&gt; {
            cameraPosition = camera.object3D.position;
            markerPosition = marker.object3D.position;
            distance = cameraPosition.distanceTo(markerPosition)

            // do what you want with the distance:
            console.log(distance);
        }, 100);
    });

    marker.addEventListener('markerLost', () =&gt; {
      clearInterval(check);
    })
})
</code></pre></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../js/jquery-3.6.0.min.js"></script>
        <script src="../js/bootstrap.min.js"></script>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js"></script>
        <script src="../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
